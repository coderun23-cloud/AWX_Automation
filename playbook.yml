---
- name: Interactive Hostname Configuration
  hosts: access_point
  gather_facts: no

  tasks:
    - name: Get current hostname
      cisco.ios.ios_command:
        commands:
          - show running-config | include hostname
      register: current_hostname

    - name: Display current device hostname
      debug:
        msg: "Current hostname: {{ current_hostname.stdout[0] | default('Not set') }}"

    - name: Prompt for new hostname
      pause:
        prompt: |
          ========================================
          Current hostname: {{ current_hostname.stdout[0] | default('Not set') }}

          Enter NEW hostname (or press Enter to keep current):
          ========================================
      register: user_input

    - name: Configure new hostname
      when: user_input.user_input | length > 0
      cisco.ios.ios_config:
        lines:
          - hostname {{ user_input.user_input }}
      register: config_change

    - name: Verify new hostname
      when: user_input.user_input | length > 0
      cisco.ios.ios_command:
        commands:
          - show running-config | include hostname
      register: new_hostname

    - name: Show configuration result
      debug:
        msg: |
          ========================================
          Hostname change result:
          Previous: {{ current_hostname.stdout[0] | default('Not set') }}
          New: {{ new_hostname.stdout[0] | default('No change made') }}
          Status: {{ 'Changed successfully' if user_input.user_input | length > 0 else 'No change - kept original' }}
          ========================================
